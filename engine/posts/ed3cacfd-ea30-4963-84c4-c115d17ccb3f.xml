<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<post>
  <author>brianbruff</author>
  <title>BlogEngine and Silverlight</title>
  <description>Hosting a sliverlight contorl in BlogEngine</description>
  <content>&lt;p&gt;I've had a few people asking me how did I host Silverlight 3 in blog engine.&lt;/p&gt;  &lt;h1&gt;Silverlight Usercontrol&lt;/h1&gt;  &lt;p&gt;It was pretty simple really (when you know how)&lt;/p&gt;  &lt;p&gt;Basically Silverlight3 needs an &amp;lt;object&amp;gt; tag.&lt;/p&gt;  &lt;p&gt;So I created a user control with the object tag and some script handling for client side errors (actually VS2010 did all the hard lifting).&lt;/p&gt;  &lt;p&gt; [code:c#] &lt;/p&gt;  &lt;p&gt;&amp;lt;%@ Control Language=&amp;quot;C#&amp;quot; ClassName=&amp;quot;SilverlightControl&amp;quot; %&amp;gt;&lt;/p&gt;  &lt;p&gt;&amp;lt;script runat=&amp;quot;server&amp;quot;&amp;gt;&lt;/p&gt;  &lt;p&gt;&amp;lt;/script&amp;gt;&lt;/p&gt;  &lt;p&gt;   &lt;br /&gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;~/Silverlight.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; function onSilverlightError(sender, args) {    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; var appSource = &amp;quot;&amp;quot;;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; if (sender != null &amp;amp;&amp;amp; sender != 0) {    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; appSource = sender.getHost().Source;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; }&lt;/p&gt;  &lt;p&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; var errorType = args.ErrorType;   &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; var iErrorCode = args.ErrorCode;&lt;/p&gt;  &lt;p&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; if (errorType == &amp;quot;ImageError&amp;quot; || errorType == &amp;quot;MediaError&amp;quot;) {   &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; return;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; }&lt;/p&gt;  &lt;p&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; var errMsg = &amp;quot;Unhandled Error in Silverlight Application &amp;quot; + appSource + &amp;quot;\n&amp;quot;;&lt;/p&gt;  &lt;p&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; errMsg += &amp;quot;Code: &amp;quot; + iErrorCode + &amp;quot;&amp;#160;&amp;#160;&amp;#160; \n&amp;quot;;   &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; errMsg += &amp;quot;Category: &amp;quot; + errorType + &amp;quot;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; \n&amp;quot;;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; errMsg += &amp;quot;Message: &amp;quot; + args.ErrorMessage + &amp;quot;&amp;#160;&amp;#160;&amp;#160;&amp;#160; \n&amp;quot;;&lt;/p&gt;  &lt;p&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; if (errorType == &amp;quot;ParserError&amp;quot;) {   &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; errMsg += &amp;quot;File: &amp;quot; + args.xamlFile + &amp;quot;&amp;#160;&amp;#160;&amp;#160;&amp;#160; \n&amp;quot;;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; errMsg += &amp;quot;Line: &amp;quot; + args.lineNumber + &amp;quot;&amp;#160;&amp;#160;&amp;#160;&amp;#160; \n&amp;quot;;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; errMsg += &amp;quot;Position: &amp;quot; + args.charPosition + &amp;quot;&amp;#160;&amp;#160;&amp;#160;&amp;#160; \n&amp;quot;;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; }    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; else if (errorType == &amp;quot;RuntimeError&amp;quot;) {    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; if (args.lineNumber != 0) {    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; errMsg += &amp;quot;Line: &amp;quot; + args.lineNumber + &amp;quot;&amp;#160;&amp;#160;&amp;#160;&amp;#160; \n&amp;quot;;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; errMsg += &amp;quot;Position: &amp;quot; + args.charPosition + &amp;quot;&amp;#160;&amp;#160;&amp;#160;&amp;#160; \n&amp;quot;;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; }    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; errMsg += &amp;quot;MethodName: &amp;quot; + args.methodName + &amp;quot;&amp;#160;&amp;#160;&amp;#160;&amp;#160; \n&amp;quot;;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; }&lt;/p&gt;  &lt;p&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; throw new Error(errMsg);   &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; }    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;/script&amp;gt;&lt;/p&gt;  &lt;p&gt;&amp;#160;&amp;#160; &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;div id=&amp;quot;silverlightControlHost&amp;quot;&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;object data=&amp;quot;data:application/x-silverlight-2,&amp;quot; type=&amp;quot;application/x-silverlight-2&amp;quot; width=&amp;quot;100%&amp;quot; height=&amp;quot;100%&amp;quot;&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;param name=&amp;quot;source&amp;quot; value=&amp;quot;&lt;a href="/clientbin/blogengine.ui.xap&amp;quot;/"&gt;&amp;lt;%Silverlight.xbap%&amp;gt;&amp;quot;/&lt;/a&gt;&amp;gt;&amp;#160;&amp;#160; // where &amp;lt;%Silverlight.xbap%&amp;gt; is location of silverlight xbap    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;param name=&amp;quot;onError&amp;quot; value=&amp;quot;onSilverlightError&amp;quot; /&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;param name=&amp;quot;background&amp;quot; value=&amp;quot;white&amp;quot; /&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;param name=&amp;quot;minRuntimeVersion&amp;quot; value=&amp;quot;3.0.40818.0&amp;quot; /&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;param name=&amp;quot;autoUpgrade&amp;quot; value=&amp;quot;true&amp;quot; /&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;a href=&amp;quot;&lt;a href="http://go.microsoft.com/fwlink/?LinkID=149156&amp;amp;v=3.0.40818.0"&gt;http://go.microsoft.com/fwlink/?LinkID=149156&amp;amp;v=3.0.40818.0&lt;/a&gt;&amp;quot; style=&amp;quot;text-decoration:none&amp;quot;&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; &amp;lt;img src=&amp;quot;&lt;a href="http://go.microsoft.com/fwlink/?LinkId=161376"&gt;http://go.microsoft.com/fwlink/?LinkId=161376&lt;/a&gt;&amp;quot; alt=&amp;quot;Get Microsoft Silverlight&amp;quot; style=&amp;quot;border-style:none&amp;quot;/&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &amp;lt;/a&amp;gt;    &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160; &amp;lt;/object&amp;gt;&amp;lt;iframe id=&amp;quot;_sl_historyFrame&amp;quot; style=&amp;quot;visibility:hidden;height:0px;width:0px;border:0px&amp;quot;&amp;gt;&amp;lt;/iframe&amp;gt;&amp;lt;/div&amp;gt;    &lt;br /&gt;    &lt;br /&gt;    &lt;br /&gt;    &lt;br /&gt;[/code]&lt;/p&gt;</content>
  <ispublished>True</ispublished>
  <isdeleted>False</isdeleted>
  <iscommentsenabled>True</iscommentsenabled>
  <pubDate>2009-11-05 08:58:00</pubDate>
  <lastModified>2015-07-09 11:13:21</lastModified>
  <raters>0</raters>
  <rating>0</rating>
  <slug>BlogEngine-and-Silver-Light</slug>
  <tags>
    <tag>blogengine</tag>
    <tag>silverlight</tag>
    <tag>c#</tag>
  </tags>
  <comments />
  <categories />
  <notifications />
</post>