<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<post>
  <author>brianbruff</author>
  <title>It's my football and I'm going home</title>
  <description />
  <content>&lt;p&gt;We've all created API libraries, and libraries by their nature encourage resuse.&lt;br /&gt;However what happens if you want to be selective in who else uses your assembly?&lt;br /&gt;One simplistic approach would be to ensure that the calling assembly has the same public key&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;private&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; CheckCallerAllowed() &lt;br /&gt;{&lt;br /&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;var&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; myPubKeyToken = &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;Assembly&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;.GetExecutingAssembly().GetName().GetPublicKeyToken();&lt;br /&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;var&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; entryPubKeyToken = &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;Assembly&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;.GetEntryAssembly().GetName().GetPublicKeyToken();&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; &lt;br /&gt;&lt;br /&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;if&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; (myPubKeyToken.Length != entryPubKeyToken.Length)&lt;br /&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; throw&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;new&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;ApplicationException&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #a31515; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #a31515; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #a31515; font-size: x-small;"&gt;"Assembly not licensed"&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;);&lt;br /&gt;&lt;br /&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;for&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; (&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; idx = 0; idx &amp;lt; myPubKeyToken.Count(); ++idx)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;if&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; (myPubKeyToken[idx] != entryPubKeyToken[idx])&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;throw&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #0000ff; font-size: x-small;"&gt;new&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt; &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #2b91af; font-size: x-small;"&gt;ApplicationException&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; color: #a31515; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #a31515; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; color: #a31515; font-size: x-small;"&gt;"Assembly not licensed"&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;&lt;span style="font-family: Consolas; font-size: x-small;"&gt;); &lt;br /&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Place a call to the function above in your public interface.&lt;/p&gt;
&lt;/p&gt;</content>
  <ispublished>True</ispublished>
  <iscommentsenabled>False</iscommentsenabled>
  <pubDate>2010-12-13 22:08:00</pubDate>
  <lastModified>2010-12-15 13:15:59</lastModified>
  <raters>0</raters>
  <rating>0</rating>
  <slug>Its-my-football-and-Im-going-home</slug>
  <tags>
    <tag>.net security</tag>
  </tags>
  <comments />
  <categories />
  <notifications />
</post>