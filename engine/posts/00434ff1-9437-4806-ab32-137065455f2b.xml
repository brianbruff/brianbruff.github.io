<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<post>
  <author>brianbruff</author>
  <title>WebAPI OWIN and HppClient Authorize</title>
  <description />
  <content>&lt;p&gt;Hi all, I know I promised my next post was going to be more Azure but I encountered a little task that took me a while to get working, the scenario was that I wanted to make a call to my WebAPI (MVC5) service using a C# HttpClient, the problem was that the resource I wished to access had the AuthorizeAttribute set&lt;/p&gt;  &lt;table cellspacing="0" cellpadding="2" width="400" border="0"&gt;&lt;tbody&gt;     &lt;tr&gt;       &lt;td valign="top" width="400"&gt;&lt;a href="https://briankeating.net/image.axd?picture=image_348.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="https://briankeating.net/image.axd?picture=image_thumb_349.png" width="642" height="178" /&gt;&lt;/a&gt; &lt;/td&gt;     &lt;/tr&gt;   &lt;/tbody&gt;&lt;/table&gt;  &lt;p&gt;&amp;#160;&lt;/p&gt;  &lt;p&gt;Now there’s a few ways to skin a cat but in the presence of the default Token Authorization one needs to first get a token and then use this token in subsequent requests. There is some good documentation using fiddler here: &lt;a href="http://www.asp.net/web-api/overview/security/individual-accounts-in-web-api" target="_blank"&gt;http://www.asp.net/web-api/overview/security/individual-accounts-in-web-api&lt;/a&gt;, however, there was not a lot of information on how to do this with HttpClient against Katana/Owin/MVC5, rather this information was not available in one specific place.&lt;/p&gt;  &lt;h2&gt;How&lt;/h2&gt;  &lt;table cellspacing="0" cellpadding="2" width="400" border="0"&gt;&lt;tbody&gt;     &lt;tr&gt;       &lt;td valign="top" width="400"&gt;&lt;a href="https://briankeating.net/image.axd?picture=image_350.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="https://briankeating.net/image.axd?picture=image_thumb_351.png" width="640" height="530" /&gt;&lt;/a&gt; &lt;/td&gt;     &lt;/tr&gt;   &lt;/tbody&gt;&lt;/table&gt;  &lt;p&gt;The first request gets the token and then this token is used as the Bearer for further requests.&lt;/p&gt;</content>
  <ispublished>True</ispublished>
  <isdeleted>False</isdeleted>
  <iscommentsenabled>True</iscommentsenabled>
  <pubDate>2014-10-07 21:18:01</pubDate>
  <lastModified>2014-10-07 21:27:11</lastModified>
  <raters>0</raters>
  <rating>0</rating>
  <slug>WebAPI-OWIN-and-HppClient-Authorize</slug>
  <tags>
    <tag>Owin</tag>
    <tag>MVC5</tag>
    <tag>HttpClient</tag>
    <tag>Autorize</tag>
    <tag>Token</tag>
    <tag>Username</tag>
    <tag>Password</tag>
  </tags>
  <comments />
  <categories>
    <category>67054983-5ca1-4bc7-a7b8-42b08c4ba45d</category>
    <category>600b93f7-8e42-4f27-9502-1f5894586ce6</category>
    <category>36e0214d-901e-415d-b6e8-c13b80d5e620</category>
    <category>bac1d4a9-65e0-4f8f-9d12-1ace4e2d5171</category>
  </categories>
  <notifications />
</post>