{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2012-04-05-linq-distinctby/","result":{"data":{"markdownRemark":{"html":"<p>Here is an extension method that I just had to share, TBH I’ve forgotten what I robbed the initial idea from, it wasn’t mine, but it’s something I found that I use over and over.</p>\n<p>The problem is I want to use the Distinct() extension method. However the objects I’m creating don’t override the default equality comparer, nor did I want to create a functor and supply to the overload just for this scenario.</p>\n<p>Lets have a look of what I’m dealing with.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">public class Source\n\n{\n\n    public string Code { get; set; }    \n\n    public string Name { get; set; }        \n\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Here’s what one would initially try</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">// Remove any duplicates\n\n c.DependingOnSources = c.DependingOnSources.Distinct();</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>The problem here is that I don’t use the overload that allows me to specify an equality comparer, and the class itself doesn’t have the default equality comparer.</p>\n<p>So what’s the solution?</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">var set = new HashSet&lt;string>();\n\nc.DependingOnSources = c.DependingOnSources.Where(element => set.Add(element.Name));</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>It’s a beauty it’s it, and quite simplistic, what I do is create a HashSet of the keys I want o compare, then I use use the Linq Where statement to select all the elements that I can add to the list. If you’re familiar with HashSet you’ll know that for first time we try add an element it will be not exist in the set and it gets added to the set and returns true, because the set.Add returns true.. we satisfy the Func in the Where clause and it gets added to the items that get returned.</p>\n<p>Simple ey.. yes true, but it gets better, we can make this a little more generic and leverage an extension method to do the lifting for us.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">internal static class LinqExtensions\n\n{\n\n    public static IEnumerable DistinctBy(\n\n                        this IEnumerable source, Func selector)\n\n    {\n\n        var set = new HashSet();\n\n        return source.Where(element => set.Add(selector(element)));\n\n    }\n\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>So now we can call our method like so</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">// Remove any duplicates\n\nc.DependingOnSources = c.DependingOnSources.DistinctBy(k => k.Name);\n\nNeat ey! (another common method is to use GroupBy and Select.)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>","frontmatter":{"title":"Linq DistinctBy","date":"April 05, 2012"}}},"pageContext":{"slug":"/blog/2012-04-05-linq-distinctby/"}},"staticQueryHashes":["2326376460","63159454"],"slicesMap":{}}