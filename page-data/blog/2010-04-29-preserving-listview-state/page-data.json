{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2010-04-29-preserving-listview-state/","result":{"data":{"markdownRemark":{"html":"<h2>Xaml Serialization to the rescue.</h2>\n<p>The following sample code will persist the current Listview state to disk and restore it the next time the control is loaded.</p>\n<p>[code:c#]</p>\n<p>xmlns=\"<a href=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>\"<br>\nxmlns:x=\"<a href=\"http://schemas.microsoft.com/winfx/2006/xaml\">http://schemas.microsoft.com/winfx/2006/xaml</a>\"<br>\nTitle=\"MainWindow\" Height=\"350\" Width=\"525\"<br>\nLoaded=\"OnLoaded\"</p>\n<blockquote>\n</blockquote>\n<p>[/code]</p>\n<p>Code behind</p>\n<p>[code:c#]</p>\n<p>using System;<br>\nusing System.IO;<br>\nusing System.Windows;<br>\nusing System.Windows.Controls;<br>\nusing System.Windows.Markup;</p>\n<p>namespace WpfApplication1<br>\n{<br>\n///<br>\n/// Interaction logic for MainWindow.xaml<br>\n///<br>\npublic partial class MainWindow : Window<br>\n{<br>\npublic MainWindow()<br>\n{<br>\nInitializeComponent();<br>\n}</p>\n<p>private void lvInit(object sender, EventArgs e)<br>\n{<br>\nGridView gv = lvTest.View as GridView;<br>\ngv.Columns.CollectionChanged += (s, gvE) =><br>\n{<br>\nif (gvE.Action == System.Collections.Specialized.NotifyCollectionChangedAction.Move)<br>\n{<br>\nSaveState();<br>\n}<br>\n};</p>\n<p>}</p>\n<p>private void SaveState()<br>\n{<br>\nstring lvXaml = XamlWriter.Save(lvTest);<br>\nusing (var s = new StreamWriter(@\"c:\\temp\\lv.xaml\"))<br>\n{<br>\ns.Write(lvXaml);<br>\n}<br>\n}</p>\n<p>private void OnLoaded(object sender, RoutedEventArgs e)<br>\n{<br>\nListView li = null;<br>\nif (File.Exists(@\"c:\\temp\\lv.xaml\"))<br>\nbdr.Child = (ListView)XamlReader.Load(File.OpenRead(@\"c:\\temp\\lv.xaml\"));<br>\n}</p>\n<p>}<br>\n}</p>\n<p>[/code]</p>","frontmatter":{"title":"Preserving ListView state","date":"April 29, 2010"}}},"pageContext":{"slug":"/blog/2010-04-29-preserving-listview-state/"}},"staticQueryHashes":["2326376460","63159454"],"slicesMap":{}}